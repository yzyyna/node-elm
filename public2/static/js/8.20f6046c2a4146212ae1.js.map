{"version":3,"sources":["webpack:///src/views/equipmentManage/crew-record/running/index.vue","webpack:///./src/views/equipmentManage/crew-record/running/index.vue?26e2","webpack:///./src/views/equipmentManage/crew-record/running/index.vue"],"names":["columns","label","prop","props","running","name","components","ToggleCrew","data","dataSource","dataTotal","options","index","labelIndex","paginationCfg","currentPage","pageSize","layout","pageSizes","value_date","Date","setDate","getDate","value_date_query","computed","extends_default","Object","vuex_esm","watch","selectCrew","handler","nv","this","_query","mounted","methods","queryTableData","_this","q","id","ID","p","StartTime","dayjs_min_default","format","EndTime","$api","equipment","findGeneratorStartStopRecords","then","value","arr","dataList","Data","length","forEach","e","i","obj","key","mch_name","GeneratorSetDisplayName","begin_time","common","end_time","keep_time","TolalTime","power","TolalKwh","Number","Status","push","splice","$set","catch","handleNewJump","row","handleChangePage","val","handleChangeSize","_export","screenData","GensetStartStopRecordExportV2","mchCode","starttime","endtime","res","url","window","URL","createObjectURL","Blob","link","document","createElement","style","display","href","download","decodeURI","headers","split","body","appendChild","click","diffTime","s","sT","minutes","diff","Math","floor","crew_record_running","render","_vm","_h","$createElement","_c","_self","_v","attrs","shadow","staticClass","type","range-separator","start-placeholder","end-placeholder","popper-append-to-body","placement","model","callback","$$v","expression","on","pagination","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/8.20f6046c2a4146212ae1.js","sourcesContent":["<!--\r\n * @Author Demon3443002624@qq.com\r\n * @Version 2022-5-18 14:43:51\r\n * @Description 运行记录\r\n * @Version 2022-5-18 14:44:14\r\n * @Description \r\n-->\r\n<template>\r\n  <div>\r\n    <BMainTopComponent />\r\n    <el-container>\r\n      <el-main>\r\n        <div id=\"crew-record-operating\">\r\n          <!-- <toggle-crew ></toggle-crew> -->\r\n          <el-card shadow=\"never\">\r\n            <div class=\"block\">\r\n              <span>筛选：</span>\r\n              <el-date-picker\r\n                v-model=\"value_date\"\r\n                type=\"datetimerange\"\r\n                range-separator=\"至\"\r\n                start-placeholder=\"开始时间\"\r\n                end-placeholder=\"结束时间\"\r\n                :popper-append-to-body=\"false\"\r\n                placement=\"bottom-start\"\r\n              >\r\n              </el-date-picker>\r\n            </div>\r\n            <el-button type=\"primary\" @click=\"_query\">搜索</el-button>\r\n            <!-- 2022-5-9 11:07:39 隐藏导出功能 -->\r\n            <!-- <el-button hidden type=\"primary\" @click=\"_export\">导出</el-button> -->\r\n          </el-card>\r\n          <el-card shadow=\"never\">\r\n            <table-list\r\n              :options=\"options\"\r\n              :columns=\"columns\"\r\n              :dataSource=\"dataSource\"\r\n              :dataTotal=\"dataTotal\"\r\n              :pagination=\"paginationCfg\"\r\n              @handleChangePage=\"handleChangePage\"\r\n              @handleChangeSize=\"handleChangeSize\"\r\n            />\r\n          </el-card>\r\n        </div>\r\n      </el-main>\r\n      <toggle-crew ></toggle-crew>\r\n    </el-container>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport dayjs from 'dayjs'\r\nimport { mapGetters } from 'vuex'\r\n\r\n// import _data from '../data'\r\nimport { formatTime } from '@/utils/common'\r\nimport ToggleCrew from '@/components/toggleCrew/list'\r\n\r\n// 表格头设置\r\nconst columns = [\r\n  {\r\n    label: '机组名称',\r\n    prop: 'mch_name',\r\n    props: {\r\n      // sortable: 'sortable'\r\n    }\r\n  },\r\n  {\r\n    label: '开始时间',\r\n    prop: 'begin_time'\r\n  },\r\n  {\r\n    label: '结束时间',\r\n    prop: 'end_time'\r\n  },\r\n  {\r\n    label: '持续时间',\r\n    prop: 'keep_time'\r\n  },\r\n  {\r\n    label: '发电kWh',\r\n    prop: 'power'\r\n  }\r\n]\r\nexport default {\r\n  name: `CrewRecordRunning`,\r\n  components: {\r\n    ToggleCrew\r\n  },\r\n  data() {\r\n    return {\r\n      columns,\r\n      dataSource: [],\r\n      dataTotal: 0,\r\n      options: {\r\n        index: true,\r\n        labelIndex: '序号'\r\n      },\r\n      paginationCfg: {\r\n        currentPage: 1,\r\n        pageSize: 10,\r\n        layout: 'total, sizes, prev, pager, next, jumper',\r\n        pageSizes: [10, 20, 30, 40]\r\n      },\r\n      data: [],\r\n      value_date: [new Date(new Date().setDate(new Date().getDate() - 3)), new Date()],\r\n      value_date_query: [new Date(new Date().setDate(new Date().getDate() - 3)), new Date()]\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters(['selectCrew'])\r\n  },\r\n  watch: {\r\n    selectCrew: {\r\n      handler: function (nv) {\r\n        this._query()\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this._query()\r\n  },\r\n  methods: {\r\n    // 查询数据\r\n    queryTableData() {\r\n      const q = {\r\n          id: this.selectCrew.ID\r\n        },\r\n        p = {\r\n          StartTime: dayjs(this.value_date_query[0]).format('YYYY-MM-DD HH:mm:ss'),\r\n          EndTime: dayjs(this.value_date_query[1]).format('YYYY-MM-DD HH:mm:ss')\r\n        }\r\n      this.$api.equipment\r\n        .findGeneratorStartStopRecords(p, q)\r\n        .then((value) => {\r\n          // value = _data.running\r\n          const arr = []\r\n          const dataList = value.Data\r\n          !dataList ||\r\n            dataList.length === 0 ||\r\n            dataList.forEach((e, i) => {\r\n              const obj = {\r\n                key: i,\r\n                mch_name: e.GeneratorSetDisplayName,\r\n                begin_time: formatTime(e.StartTime).format('YYYY-MM-DD HH:mm:ss'),\r\n                end_time: formatTime(e.EndTime).format('YYYY-MM-DD HH:mm:ss'),\r\n                keep_time: e.TolalTime,\r\n                power: e.TolalKwh\r\n                // keep_time: this.diffTime(e.StartTime, e.EndTime)\r\n                // power: (Number(e.EndOilLevel) - Number(e.StartOilLevel)).toFixed(1) + 'kWh'\r\n              }\r\n              // 正在运行结束时间补为‘-’\r\n              if (Number(e.Status) === 1) {\r\n                obj.end_time = '-'\r\n              }\r\n              arr.push(obj)\r\n            })\r\n          this.dataTotal = dataList.length\r\n          const dataSource = arr.splice(\r\n            (this.paginationCfg.currentPage - 1) * this.paginationCfg.pageSize,\r\n            this.paginationCfg.pageSize\r\n          )\r\n          this.$set(this, 'dataSource', dataSource)\r\n        })\r\n        .catch(() => {})\r\n    },\r\n    handleNewJump(row) {},\r\n    // 分页 当前页改变\r\n    handleChangePage(val) {\r\n      this.paginationCfg.currentPage = val\r\n      this.queryTableData()\r\n    },\r\n    // 分页 每页条数改变\r\n    handleChangeSize(val) {\r\n      this.paginationCfg.currentPage = 1\r\n      this.paginationCfg.pageSize = val\r\n      this.queryTableData()\r\n    },\r\n    // 运行记录导出\r\n    _export() {\r\n      // TODO 测试导出\r\n      const params = {\r\n        mchCode: '',\r\n        starttime: '',\r\n        endtime: ''\r\n      }\r\n\r\n      this.$api.screenData.GensetStartStopRecordExportV2(params).then((res) => {\r\n        let url = window.URL.createObjectURL(new Blob([res.data]))\r\n        let link = document.createElement('a')\r\n        link.style.display = 'none'\r\n        link.href = url\r\n        link.download =\r\n          decodeURI(res.headers['content-disposition'].split('filename=')[1]) || '未命名文件.xls'\r\n        document.body.appendChild(link)\r\n        link.click()\r\n      })\r\n    },\r\n    // 搜索\r\n    _query() {\r\n      this.paginationCfg.currentPage = 1\r\n      this.value_date_query = this.value_date\r\n      this.queryTableData()\r\n    },\r\n    // 对比时间，输出几小时几分\r\n    diffTime(s, e) {\r\n      const sT = formatTime(s)\r\n      const eT = formatTime(e)\r\n      const minutes = eT.diff(sT, 'm')\r\n      return Math.floor(minutes / 60) + 'h' + (minutes % 60) + 'min'\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n#crew-record-operating {\r\n  /deep/.el-card {\r\n    overflow: initial;\r\n    margin-bottom: 15px;\r\n    .el-card__body {\r\n      display: flex;\r\n      .el-button {\r\n        margin: 0 0 0 10px;\r\n      }\r\n    }\r\n  }\r\n  /deep/ .toggle-crew {\r\n    margin-bottom: 0;\r\n  }\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/equipmentManage/crew-record/running/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('BMainTopComponent'),_vm._v(\" \"),_c('el-container',[_c('el-main',[_c('div',{attrs:{\"id\":\"crew-record-operating\"}},[_c('el-card',{attrs:{\"shadow\":\"never\"}},[_c('div',{staticClass:\"block\"},[_c('span',[_vm._v(\"筛选：\")]),_vm._v(\" \"),_c('el-date-picker',{attrs:{\"type\":\"datetimerange\",\"range-separator\":\"至\",\"start-placeholder\":\"开始时间\",\"end-placeholder\":\"结束时间\",\"popper-append-to-body\":false,\"placement\":\"bottom-start\"},model:{value:(_vm.value_date),callback:function ($$v) {_vm.value_date=$$v},expression:\"value_date\"}})],1),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm._query}},[_vm._v(\"搜索\")])],1),_vm._v(\" \"),_c('el-card',{attrs:{\"shadow\":\"never\"}},[_c('table-list',{attrs:{\"options\":_vm.options,\"columns\":_vm.columns,\"dataSource\":_vm.dataSource,\"dataTotal\":_vm.dataTotal,\"pagination\":_vm.paginationCfg},on:{\"handleChangePage\":_vm.handleChangePage,\"handleChangeSize\":_vm.handleChangeSize}})],1)],1)]),_vm._v(\" \"),_c('toggle-crew')],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-9fd4271e\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/equipmentManage/crew-record/running/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-9fd4271e\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-9fd4271e\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-9fd4271e\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/equipmentManage/crew-record/running/index.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}
webpackJsonp([33],{JDLI:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Dd8w"),o=a.n(n),r=(a("M4fF"),a("XLwt"),{name:"CollapseComponent",components:{},data:function(){return{activeNames:[],paramDatas:{},dialogVisible:!1,dialogData:{},dialogFrom:{valueTrue:0}}},props:["parameters","gensetInfo","myProp"],computed:{},watch:{},methods:{getNumStr:function(e){var t="";switch(e){case.1:t="保留一位小数";break;case.01:t="保留两位小数";break;case.001:t="保留三位小数";break;case 1e-4:t="保留四位小数";break;case 1e-5:t="保留五位小数";break;default:t="保留整数"}return t},handleDialogCommit:function(){this.dialogVisible=!1;var e=document.getElementById("myInput+"+this.dialogData.Address);try{e.value=this.dialogFrom.valueTrue}catch(e){}},handleBtn:function(e,t){var a=this,n=this.parameters,r=this.gensetInfo,i=this.myProp,l={GeneratorId:r.ID.toString(),SheetId:i.SheetId.toString(),Type:Number(t),Name:n[t],IsReadOrder:"read"===e};this.$api.operation.getParamsDataV2(l,{}).then(function(e){var n=e.Data&&e.Data.Data,r=new Array;n&&n.length>0&&n.forEach(function(e){var t=o()({name:e.Name,value:e.Value},e);r.push(t)}),a.$set(a.paramDatas,t+"",r),e.IsSuccess&&a.$message(e.Message)})},handleClick:function(e){var t=this;this.dialogVisible=!0;var a={Address:e.Address,ProtocolId:e.ProtocolId};this.$api.operation.GetParamDetailV2(a).then(function(a){var n=a.Data;n&&(n.title="参数修改-"+n.ProjectName,n.step=n.Precision,n.Precision=t.getNumStr(n.Precision),t.dialogData=o()({},n),t.dialogFrom.valueTrue=Number(e.value))})},commitWrite:function(e){var t=this.parameters,a=this.gensetInfo,n=this.myProp,o={GeneratorId:a.ID.toString(),SheetId:n.SheetId.toString(),Type:Number(e),Data:[]},r=document.getElementsByName("myInput+"+e.toString());r instanceof NodeList&&r.forEach(function(e){var t={Address:e.id.split("+")[1],Name:e.id.split("+")[2],Value:e.value};o.Data.push(t)}),console.log(o,e,t,r[1],this.paramDatas),this.$api.operation.addRemoteParamsRecordV2(o).then(function(e){})}},beforeCreate:function(){},created:function(){var e=new Array,t=new Object;for(var a in this.parameters)e.push(a+""),t[a+""]=[];this.activeNames=e,this.paramDatas=t},beforeMount:function(){},mounted:function(){},beforeUpdated:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}}),i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},e._l(e.parameters,function(t,n){return a("el-collapse-item",{key:n,attrs:{name:n+""}},[a("template",{slot:"title"},[e._v("\n        "+e._s(t)+"\n      ")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleBtn("read",n)}}},[e._v("读取 ")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleBtn("refresh",n)}}},[e._v("刷新 ")]),e._v(" "),a("div",{staticClass:"form-container"},[a("el-row",e._l(e.paramDatas[n],function(t,o){return a("el-col",{key:o,staticClass:"form-item",attrs:{span:8}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-row",{attrs:{type:"flex",justify:"end"}},[e._v(" "+e._s(t.name)+" ")])],1),e._v(" "),a("el-col",{attrs:{span:10}},[a("el-input",{attrs:{id:"myInput+"+t.Address+"+"+t.Name,name:"myInput+"+n.toString(),disabled:"",value:t.value},nativeOn:{click:function(a){return e.handleClick(t)}}})],1),e._v(" "),a("el-col",{class:{"text-reading":!t.value,"text-success":!!t.value},attrs:{span:6}},[e._v("\n                "+e._s(t.value?"读取成功":"读取中")+"\n              ")])],1)],1)}),1),e._v(" "),a("br"),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"end"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.commitWrite(n)}}},[e._v(" 写入 ")])],1),e._v(" "),a("el-dialog",{attrs:{width:"50%",title:e.dialogData.title,"show-close":!1,visible:e.dialogVisible,"modal-append-to-body":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-row",{staticClass:"dialog-form"},[a("el-row",[a("el-col",{attrs:{span:18}},[a("el-slider",{attrs:{max:e.dialogData.MaxValue,min:e.dialogData.MinValue},model:{value:e.dialogFrom.valueTrue,callback:function(t){e.$set(e.dialogFrom,"valueTrue",t)},expression:"dialogFrom.valueTrue"}})],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("div",{style:{width:"80%",marginLeft:"10%"}},[a("el-input-number",{attrs:{size:"mini",max:e.dialogData.MaxValue,min:e.dialogData.MinValue,step:e.dialogData.step,"controls-position":"right"},model:{value:e.dialogFrom.valueTrue,callback:function(t){e.$set(e.dialogFrom,"valueTrue",t)},expression:"dialogFrom.valueTrue"}})],1)])],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[e._v("\n                范围： "+e._s(e.dialogData.MinValue)+" ~ "+e._s(e.dialogData.MaxValue)+"\n              ")]),e._v(" "),a("el-col",{attrs:{span:8}},[e._v(" 精度："+e._s(e.dialogData.Precision)+" ")]),e._v(" "),a("el-col",{attrs:{span:8}},[e._v(" 单位："+e._s(e.dialogData.Unit)+" ")])],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleDialogCommit}},[e._v("确 定")])],1)],1)],1)],2)}),1)],1)},staticRenderFns:[]};var l={name:"RemoteTuningOperation",components:{CollapseComponent:a("VU/8")(r,i,!1,function(e){a("qplX")},"data-v-f6d584bc",null).exports},data:function(){return{formInline:{DisplayName:"",CollectorToken:"",ControllerBrand:"",ProtocolName:"",InstallationSite:"",GenCoollectorName:"",IsOnduty:""},activeTabName:"1",collapseOpt:{1:{101:"参数-市电",102:"参数-发电",103:"参数-发动机",104:"参数-系统/延时",105:"参数-同步/负载",106:"参数-通信",107:"参数-监测",108:"参数-维护保养",109:"参数-模拟量校准",110:"参数-开关量输入",111:"参数-模拟量输入",112:"参数-开关量/PWM输出",113:"参数-保留",114:"参数-可编程输出",115:"参数-可编程输入",116:"参数-校验"},2:{201:"功能-市电",202:"功能-发电",203:"功能-发动机",204:"功能-系统/延时",205:"功能-同步/负载",206:"功能-通信",207:"功能-监测",208:"功能-维护保养",209:"功能-模拟量校准",210:"功能-开关量输入",211:"功能-模拟量输入",212:"功能-开关量/PWM输出",213:"功能-保留"},3:{301:"图表-温度传感器",302:"图表-压力传感器",303:"图表-液位传感器",304:"图表-机油压力监测",305:"图表-工况统计",306:"图表-测量转速",307:"图表-限功率",308:"图表-电子铭牌",309:"图表-保留"},4:{401:"测量-市电",402:"测量-发电",403:"测量-发动机",404:"测量-系统状态",405:"测量-同步/负载",406:"测量-通信",407:"测量-监测",408:"测量-维护保养",409:"测量-输入状态",410:"测量-开关量输入",411:"测量-模拟量输入",412:"测量-谐波分析",413:"测量-保留",414:"测量-历史记录"}},collapseOptNamesMapping:{1:"参数",2:"功能",3:"图表",4:"测量"},writeRecords:[]}},props:["myProp"],computed:{renderParameters:function(){var e=[],t=this.writeRecords;for(var a in this.collapseOpt){var n={},o=this.collapseOpt[a];for(var r in o)t.includes(r)&&(n[r]=o[r]);e.push(n)}return e}},watch:{myProp:{handler:function(e){this.getData()},immediate:!0}},methods:{handleBackBtn:function(){this.$emit("changeIs","MainPage")},handleCommitBtn:function(){var e=this;this.$api.operation.completeRemoteParams().then(function(t){e.$emit("changeIs","MainPage")})},getData:function(){var e=this,t=this.myProp,a={generatorId:t.GeneratorSetId,id:t.No};this.$api.operation.getProtocolParmasByGeneatorId(a,{}).then(function(t){var a=t.Data&&t.Data.genset,n=t.Data&&t.Data.list,r=t.Data&&t.Data.writeRecords;a&&(e.formInline=o()({},a)),n&&Array.isArray(n),r&&Array.isArray(r)&&(e.writeRecords=r.map(function(e){return e.toString()}))})}},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeUpdated:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"remote-tuning-operation"},[a("el-card",{staticClass:"info-container"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("机组信息")]),e._v(" "),a("el-button",{style:{position:"absolute",right:"110px",top:"30px"},attrs:{type:"success"},on:{click:e.handleCommitBtn}},[e._v("\n          完成服务\n        ")]),e._v(" "),a("el-button",{style:{position:"absolute",right:"30px",top:"30px"},on:{click:e.handleBackBtn}},[e._v("\n          返回\n        ")])],1),e._v(" "),a("el-form",{staticClass:"demo-form-inline",attrs:{disabled:"",inline:!0,model:e.formInline}},[a("el-form-item",{attrs:{label:"机组名称"}},[e._v("\n          "+e._s(e.formInline.DisplayName)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"云猫标识"}},[e._v("\n          "+e._s(e.formInline.CollectorToken)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"控制器品牌"}},[e._v("\n          "+e._s(e.formInline.ControllerBrand)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"调参协议"}},[e._v("\n          "+e._s(e.formInline.ProtocolName)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"安装地点"}},[e._v("\n          "+e._s(e.formInline.InstallationSite)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"通讯协议"}},[e._v("\n          "+e._s(e.formInline.GenCoollectorName)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"有人值守"}},[e._v("\n          "+e._s(e.formInline.IsOnduty?"是":"否")+"\n        ")])],1)],1),e._v(" "),a("el-row",{staticClass:"detail-container"},[a("el-tabs",{model:{value:e.activeTabName,callback:function(t){e.activeTabName=t},expression:"activeTabName"}},[a("el-tab-pane",{attrs:{label:"参数",name:"1"}},[a("collapse-component",{attrs:{myProp:e.myProp,parameters:e.renderParameters[0],gensetInfo:e.formInline}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"功能",name:"2"}},[a("collapse-component",{attrs:{myProp:e.myProp,parameters:e.renderParameters[1],gensetInfo:e.formInline}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"曲线",name:"3"}},[a("collapse-component",{attrs:{myProp:e.myProp,parameters:e.renderParameters[2],gensetInfo:e.formInline}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"测量",name:"4"}},[a("collapse-component",{attrs:{myProp:e.myProp,parameters:e.renderParameters[3],gensetInfo:e.formInline}})],1)],1)],1)],1)])},staticRenderFns:[]};var c=a("VU/8")(l,s,!1,function(e){a("JVRL")},"data-v-66788dee",null);t.default=c.exports},JVRL:function(e,t){},qplX:function(e,t){}});
//# sourceMappingURL=33.04bc0a9e160dd05b1a4e.js.map
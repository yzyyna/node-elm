webpackJsonp([44],{"76on":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Dd8w"),o=a.n(n),s=a("fALy"),i=a("NYxO"),r=a("j9eq"),l={name:"crewinfo",mixins:[s.a],components:{PositionCascader:r.a},data:function(){return{crewStatusList:["离线","停机","警告","报警","运行"],tabs:[{type:"GensetAll",status:0,label:"全部机组",value:0},{type:"GensetRun",status:4,label:"运行",value:0},{type:"GensetAlarm",status:2,label:"报警",value:0},{type:"GensetWarn",status:3,label:"警告",value:0},{type:"GensetStop",status:5,label:"停机",value:0},{type:"GensetOffline",status:6,label:"离线",value:0}],searchForm:{crewStatus:0,crewCode:"",crewPosition:""},loading:!1,columns:[{label:"机组名称",prop:"DisplayName",minWidth:"12%"},{label:"机组状态",prop:"StatusText",minWidth:"5%"},{label:"安装地点",prop:"InstallationSite",minWidth:"12%"},{label:"经纬度",prop:"LongitudeAndLatitude",minWidth:"12%"}],dataSource:[],options:{index:!0,labelIndex:"序号",props:{width:160}}}},mounted:function(){this.getCrewStatusCount(),this.queryTableData()},methods:o()({},Object(i.b)(["toggleSelectCrew"]),{getCrewStatusCount:function(){var t=this;this.$api.equipment.findGenSetStatusCount({DisplayMode:1,IsLease:1,UserID:-1}).then(function(e){var a=e.Data;e.IsSuccess&&t.tabs.forEach(function(t){t.value=a[t.type]})})},queryTableData:function(){var t=this,e={Page:this.paginationCfg.currentPage,PageSize:this.paginationCfg.pageSize},a={model:{DisplayMode:1,IsLease:1,UserID:-1,StatusMode:this.searchForm.crewStatus,CollectorToken:this.searchForm.crewCode,InstallationSite:this.searchForm.crewPosition}};this.loading=!0,this.$api.common.getCrewList(a,e).then(function(e){if(e.IsSuccess){var a=e.Data;t.dataSource=a.Data.map(function(e){return e.LongitudeAndLatitude=e.Longitude+","+e.Latitude,e.StatusText=t.crewStatusList[e.Status],e}),t.dataTotal=a.TotalItemCount,t.loading=!1}}).catch(function(){t.loading=!1})},changeStatus:function(t){this.searchForm.crewStatus=t,this.resetCurrentParams()},showDetail:function(t,e){var a=0===e?"/equipment/crewinfo-detail":"/equipment/crewreport-detail";this.toggleSelectCrew(t),window.open("/#"+a)},positionChange:function(t){this.searchForm.crewPosition=t.crewPosition}})},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("BMainTopComponent"),t._v(" "),a("div",{attrs:{id:"crewinfo"}},[a("div",{staticClass:"tab-box"},t._l(t.tabs,function(e){return a("el-button",{key:e.status,class:["status-tab",{"select-tab":t.searchForm.crewStatus==e.status}],on:{click:function(a){return t.changeStatus(e.status)}}},[t._v(t._s(e.label)+"("+t._s(e.value)+")")])}),1),t._v(" "),a("div",{staticClass:"search-box"},[a("div",{staticClass:"search-item"},[a("span",[t._v("机组编码搜索:")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入机组编码","suffix-icon":"el-icon-date"},model:{value:t.searchForm.crewCode,callback:function(e){t.$set(t.searchForm,"crewCode",e)},expression:"searchForm.crewCode"}})],1),t._v(" "),a("div",{staticClass:"search-item"},[a("span",[t._v("机组位置筛选:")]),t._v(" "),a("position-cascader",{attrs:{placeholder:"请选择机组所在位置",defaultPosition:t.searchForm.crewPosition},on:{positionChange:t.positionChange}})],1),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.resetCurrentParams()}}},[t._v("查 询")])],1),t._v(" "),a("TableList",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{options:t.options,columns:t.columns,dataSource:t.dataSource,dataTotal:t.dataTotal,pagination:t.paginationCfg,border:""},on:{handleChangePage:t.handleChangePage,handleChangeSize:t.handleChangeSize}},[a("el-table-column",t._b({attrs:{slot:"operation",label:"操作",align:"center"},slot:"operation",scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"operate-group"},[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.showDetail(e.row,0)}}},[t._v(" 机组信息 ")]),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.showDetail(e.row,1)}}},[t._v(" 机组报告 ")])],1)]}}])},"el-table-column",t.options&&t.options.props,!1))],1)],1)],1)},staticRenderFns:[]};var u=a("VU/8")(l,c,!1,function(t){a("of55")},"data-v-a0e3e9f0",null);e.default=u.exports},of55:function(t,e){}});
//# sourceMappingURL=44.a242bed90eca2e23500e.js.map